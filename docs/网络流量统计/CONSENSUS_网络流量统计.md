# 网络流量统计分析工具 - 共识文档

## 项目基本信息
- **项目名称**: 网络流量统计分析工具
- **开发语言**: Python
- **目标用户**: 计算机网络课程设计
- **开发周期**: 预计2-3周

## 最终确认的技术方案

### 1. 数据包过滤策略
**决策**: 捕获IP包并包含常见协议
- **包含协议**: TCP、UDP、ICMP、HTTP
- **排除协议**: 复杂的路由协议、加密协议等难以解析的协议
- **实现方式**: 使用Scapy的过滤器 `filter="ip"`
- **扩展性**: 预留协议扩展接口，便于后续添加新协议

### 2. 统计时间窗口
**决策**: 累计统计模式
- **统计方式**: 从程序启动开始累计统计
- **数据持久化**: 支持导出统计结果
- **重置功能**: 提供清零重新统计功能
- **历史记录**: 保留会话期间的完整统计数据

### 3. 图表更新频率
**决策**: 定时刷新，用户可选周期
- **刷新周期选项**: 
  - 1秒（实时性强，适合演示）
  - 5秒（平衡性能和实时性）
  - 10秒（低资源消耗）
  - 30秒（长期监控）
- **实现方式**: 使用Tkinter的after()方法定时更新
- **性能优化**: 避免频繁重绘，只更新变化的数据

### 4. 界面布局设计
**决策**: 待Architect阶段详细设计
- **基本要求**: 
  - 左侧：统计数据列表（源IP、数据包数量、流量大小）
  - 右侧：图表展示区域
  - 顶部：控制面板（开始/停止、刷新周期选择、导出功能）
  - 底部：状态栏（当前状态、统计信息）

## 技术架构确认

### 核心模块
1. **数据包捕获模块** (sniffer)
   - 使用Scapy进行数据包捕获
   - 支持网络接口选择
   - 实现数据包过滤

2. **数据处理模块** (processor)
   - 解析数据包信息
   - 按源IP进行统计
   - 计算流量大小

3. **可视化模块** (visualizer)
   - Tkinter GUI界面
   - Matplotlib图表绘制
   - 实时数据更新

4. **主控制模块** (main)
   - 协调各模块工作
   - 处理用户交互
   - 管理程序生命周期

### 开发约束
- **平台兼容性**: Windows优先，考虑跨平台
- **权限要求**: 需要管理员权限进行网络抓包
- **性能要求**: 支持中等流量网络环境
- **用户体验**: 界面简洁，操作直观

## 验收标准

### 功能性要求
- [x] 实时捕获网络数据包
- [x] 按源IP统计数据包数量和流量
- [x] 图形化界面展示统计结果
- [x] 支持开始/停止抓包控制
- [x] 可选择图表刷新频率
- [x] 支持统计数据导出

### 非功能性要求
- [x] 界面响应时间 < 1秒
- [x] 支持至少100个不同源IP的统计
- [x] 内存使用 < 100MB
- [x] CPU使用率 < 20%（正常网络流量下）

### 交付物要求
- [x] 完整的Python源代码
- [x] requirements.txt依赖文件
- [x] README.md使用说明
- [x] 课程设计报告（15页以上）
- [x] PlantUML架构图表

## 风险控制

### 已识别风险
1. **权限问题**: 需要管理员权限抓包
   - **缓解措施**: 提供权限检查和提示功能

2. **性能问题**: 高流量环境下可能卡顿
   - **缓解措施**: 实现数据包采样和缓存机制

3. **兼容性问题**: 不同网络环境的适配
   - **缓解措施**: 提供网络接口选择功能

## 下一步行动
1. 进入Architect阶段，设计详细的系统架构
2. 创建DESIGN文档，包含架构图和接口定义
3. 确定具体的界面布局设计
4. 制定详细的开发计划

---
**文档状态**: 已确认  
**创建时间**: 2024年1月  
**最后更新**: 2024年1月  
**负责人**: 课程设计团队