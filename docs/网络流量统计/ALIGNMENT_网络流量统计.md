# 项目对齐文档 (ALIGNMENT) - 网络流量统计

**项目名称：** 网络流量统计分析工具 (Network Traffic Statistics Analyzer)

**创建时间：** 2024年

**负责人：** Claude 4 Sonnet

---

## 1. 项目上下文分析

### 1.1 现有项目结构
```
d:\项目\计算机网络课设/
├── docs\
│   ├── HANDOVER_TO_CLAUDE.md          # Gemini交接文档
│   └── 课程设计报告.md                 # 已完成前两章
└── 课程设计要求以及实验报告模板\       # 课程要求文档
```

### 1.2 技术栈分析
- **编程语言：** Python 3.8+
- **GUI框架：** Tkinter (标准库)
- **网络抓包：** Scapy
- **数据可视化：** Matplotlib
- **底层依赖：** Npcap (Windows环境)

### 1.3 架构模式
- **分层架构：** 界面层 → 业务逻辑层 → 数据访问层
- **模块化设计：** 抓包模块、处理模块、可视化模块、GUI模块
- **事件驱动：** GUI事件处理机制

## 2. 需求理解确认

### 2.1 原始需求
根据交接文档，核心需求包括：
1. 实时捕获指定网卡的IP数据包
2. 按源IP地址统计在特定时间段内发出的数据包个数
3. 通过GUI界面进行操作（开始/停止捕获、选择网卡等）
4. 将统计结果用图形化（如柱状图）表示

### 2.2 功能性需求
- **F1 网络接口管理：** 检测并列出可用网络接口
- **F2 数据包捕获：** 实时捕获指定接口的IP数据包
- **F3 流量统计：** 按源IP统计数据包数量和字节数
- **F4 数据可视化：** 生成柱状图展示统计结果
- **F5 GUI交互：** 提供用户友好的图形界面
- **F6 实时更新：** 动态刷新统计数据和图表

### 2.3 非功能性需求
- **性能要求：** 能处理中等流量网络环境（<1000 pps）
- **可用性：** 界面简洁直观，操作便捷
- **兼容性：** Windows 10/11 环境
- **稳定性：** 长时间运行不崩溃
- **扩展性：** 模块化设计便于功能扩展

### 2.4 边界确认
**包含范围：**
- 基本的IP数据包捕获和统计
- 简单的GUI界面和图表展示
- 基础的错误处理

**不包含范围：**
- 深度包检测（DPI）
- 复杂的网络协议分析
- 数据持久化存储
- 网络安全检测功能

### 2.5 验收标准
1. 能够成功检测并选择网络接口
2. 能够捕获并解析IP数据包
3. 统计结果准确无误
4. GUI界面响应流畅
5. 图表显示清晰美观
6. 程序运行稳定，无内存泄漏

## 3. 技术实现方案

### 3.1 建议项目结构
```
LightweightPacketAnalyzer/
├── src/
│   ├── main.py           # GUI主程序入口
│   ├── sniffer.py        # 网络抓包模块
│   ├── processor.py      # 数据处理统计模块
│   └── visualizer.py     # 图表生成显示模块
├── requirements.txt      # 项目依赖
├── README.md            # 项目说明
└── .env                 # 环境配置（如有需要）
```

### 3.2 技术约束
- 必须使用Python标准库和指定的第三方库
- GUI必须基于Tkinter实现
- 图表必须嵌入到GUI界面中
- 需要处理Windows环境下的权限问题

### 3.3 集成方案
- 使用线程分离GUI和数据捕获逻辑
- 通过队列机制实现模块间数据传递
- 采用观察者模式更新GUI显示

## 4. 疑问澄清

### 4.1 技术实现疑问
1. **数据包过滤策略：** 是否只捕获TCP/UDP包，还是所有IP包？
2. **统计时间窗口：** 是累计统计还是滑动窗口统计？
3. **图表更新频率：** 实时更新还是定时刷新？
4. **数据存储方式：** 是否需要导出统计结果？

### 4.2 用户体验疑问
1. **界面布局：** 统计列表和图表的布局比例？
2. **交互方式：** 是否需要右键菜单或快捷键？
3. **错误提示：** 权限不足或网卡异常时的处理方式？

### 4.3 性能考虑
1. **内存管理：** 长时间运行时的数据清理策略？
2. **CPU占用：** 高流量时的性能优化方案？
3. **线程安全：** 多线程访问共享数据的同步机制？

## 5. 风险评估

### 5.1 技术风险
- **权限问题：** Windows环境下抓包需要管理员权限
- **依赖安装：** Npcap安装可能遇到兼容性问题
- **性能瓶颈：** 高流量环境下可能出现丢包

### 5.2 开发风险
- **学习曲线：** Scapy库的复杂性
- **调试困难：** 网络相关问题难以复现
- **测试环境：** 需要真实网络环境进行测试

## 6. 下一步行动

1. 使用Context 7查询Scapy和Tkinter最佳实践
2. 创建项目目录结构
3. 进入Architect阶段，设计详细架构
4. 确认技术疑问和实现细节

---

**状态：** 待确认关键决策点
**下一阶段：** Architect（架构设计）